import pandas as pd
import matplotlib.pyplot as plt

col_drop = ['apply_pdl_1', 'apply_int_1', 'apply_sum_1', 'reject_pdl_1', 'reject_int_1', 'reject_sum_1', 'approve_pdl_1', 'approve_int_1', 'approve_sum_1', 'loanamount_pdl_1', 'loanamount_int_1', 'loanamount_sum_1', 'approve_rate_pdl_1', 'approve_rate_int_1', 'approve_rate_sum_1', 'reject_rate_pdl_1', 'reject_rate_int_1', 'reject_rate_sum_1', 'loan_rate_pdl_1', 'loan_rate_int_1', 'loan_rate_sum_1', 'loan_avg_pdl_1', 'loan_avg_int_1', 'loan_avg_sum_1', 'loan_times_pdl_1', 'loan_times_int_1', 'loan_times_sum_1', 'overdue_pdl_1', 'overdue_int_1', 'overdue_sum_1', 'pd7_pdl_1', 'pd7_int_1', 'pd7_sum_1', 'pd14_pdl_1', 'pd14_int_1', 'pd14_sum_1', 'M1_pdl_1', 'M1_int_1', 'M1_sum_1', 'maxOverdue_pdl_1', 'maxOverdue_int_1', 'maxOverdue_sum_1', 'avg_overdueday_pdl_1', 'avg_overdueday_int_1', 'avg_overdueday_sum_1', 'overdue_rate_pdl_1', 'overdue_rate_int_1', 'overdue_rate_sum_1', 'apply_pdl_3', 'apply_int_3', 'apply_sum_3', 'reject_pdl_3', 'reject_int_3', 'reject_sum_3', 'approve_pdl_3', 'approve_int_3', 'approve_sum_3', 'loanamount_pdl_3', 'loanamount_int_3', 'loanamount_sum_3', 'approve_rate_pdl_3', 'approve_rate_int_3', 'approve_rate_sum_3', 'reject_rate_pdl_3', 'reject_rate_int_3', 'reject_rate_sum_3', 'loan_rate_pdl_3', 'loan_rate_int_3', 'loan_rate_sum_3', 'loan_avg_pdl_3', 'loan_avg_int_3', 'loan_avg_sum_3', 'loan_times_pdl_3', 'loan_times_int_3', 'loan_times_sum_3', 'overdue_pdl_3', 'overdue_int_3', 'overdue_sum_3', 'pd7_pdl_3', 'pd7_int_3', 'pd7_sum_3', 'pd14_pdl_3', 'pd14_int_3', 'pd14_sum_3', 'M1_pdl_3', 'M1_int_3', 'M1_sum_3', 'maxOverdue_pdl_3', 'maxOverdue_int_3', 'maxOverdue_sum_3', 'avg_overdueday_pdl_3', 'avg_overdueday_int_3', 'avg_overdueday_sum_3', 'overdue_rate_pdl_3', 'overdue_rate_int_3', 'overdue_rate_sum_3', 'apply_pdl_7', 'apply_int_7', 'apply_sum_7', 'reject_pdl_7', 'reject_int_7', 'reject_sum_7', 'approve_pdl_7', 'approve_int_7', 'approve_sum_7', 'loanamount_pdl_7', 'loanamount_int_7', 'loanamount_sum_7', 'approve_rate_pdl_7', 'approve_rate_int_7', 'approve_rate_sum_7', 'reject_rate_pdl_7', 'reject_rate_int_7', 'reject_rate_sum_7', 'loan_rate_pdl_7', 'loan_rate_int_7', 'loan_rate_sum_7', 'loan_avg_pdl_7', 'loan_avg_int_7', 'loan_avg_sum_7', 'loan_times_pdl_7', 'loan_times_int_7', 'loan_times_sum_7', 'overdue_pdl_7', 'overdue_int_7', 'overdue_sum_7', 'pd7_pdl_7', 'pd7_int_7', 'pd7_sum_7', 'pd14_pdl_7', 'pd14_int_7', 'pd14_sum_7', 'M1_pdl_7', 'M1_int_7', 'M1_sum_7', 'maxOverdue_pdl_7', 'maxOverdue_int_7', 'maxOverdue_sum_7', 'avg_overdueday_pdl_7', 'avg_overdueday_int_7', 'avg_overdueday_sum_7', 'overdue_rate_pdl_7', 'overdue_rate_int_7', 'overdue_rate_sum_7', 'apply_pdl_14', 'apply_int_14', 'apply_sum_14', 'reject_pdl_14', 'reject_int_14', 'reject_sum_14', 'approve_pdl_14', 'approve_int_14', 'approve_sum_14', 'loanamount_pdl_14', 'loanamount_int_14', 'loanamount_sum_14', 'approve_rate_pdl_14', 'approve_rate_int_14', 'approve_rate_sum_14', 'reject_rate_pdl_14', 'reject_rate_int_14', 'reject_rate_sum_14', 'loan_rate_pdl_14', 'loan_rate_int_14', 'loan_rate_sum_14', 'loan_avg_pdl_14', 'loan_avg_int_14', 'loan_avg_sum_14', 'loan_times_pdl_14', 'loan_times_int_14', 'loan_times_sum_14', 'overdue_pdl_14', 'overdue_int_14', 'overdue_sum_14', 'pd7_pdl_14', 'pd7_int_14', 'pd7_sum_14', 'pd14_pdl_14', 'pd14_int_14', 'pd14_sum_14', 'M1_pdl_14', 'M1_int_14', 'M1_sum_14', 'maxOverdue_pdl_14', 'maxOverdue_int_14', 'maxOverdue_sum_14', 'avg_overdueday_pdl_14', 'avg_overdueday_int_14', 'avg_overdueday_sum_14', 'overdue_rate_pdl_14', 'overdue_rate_int_14', 'overdue_rate_sum_14', 'apply_pdl_30', 'apply_int_30', 'apply_sum_30', 'reject_pdl_30', 'reject_int_30', 'reject_sum_30', 'approve_pdl_30', 'approve_int_30', 'approve_sum_30', 'loanamount_pdl_30', 'loanamount_int_30', 'loanamount_sum_30', 'approve_rate_pdl_30', 'approve_rate_int_30', 'approve_rate_sum_30', 'reject_rate_pdl_30', 'reject_rate_int_30', 'reject_rate_sum_30', 'loan_rate_pdl_30', 'loan_rate_int_30', 'loan_rate_sum_30', 'loan_avg_pdl_30', 'loan_avg_int_30', 'loan_avg_sum_30', 'loan_times_pdl_30', 'loan_times_int_30', 'loan_times_sum_30', 'overdue_pdl_30', 'overdue_int_30', 'overdue_sum_30', 'pd7_pdl_30', 'pd7_int_30', 'pd7_sum_30', 'pd14_pdl_30', 'pd14_int_30', 'pd14_sum_30', 'M1_pdl_30', 'M1_int_30', 'M1_sum_30', 'maxOverdue_pdl_30', 'maxOverdue_int_30', 'maxOverdue_sum_30', 'avg_overdueday_pdl_30', 'avg_overdueday_int_30', 'avg_overdueday_sum_30', 'overdue_rate_pdl_30', 'overdue_rate_int_30', 'overdue_rate_sum_30', 'apply_pdl_60', 'apply_int_60', 'apply_sum_60', 'reject_pdl_60', 'reject_int_60', 'reject_sum_60', 'approve_pdl_60', 'approve_int_60', 'approve_sum_60', 'loanamount_pdl_60', 'loanamount_int_60', 'loanamount_sum_60', 'approve_rate_pdl_60', 'approve_rate_int_60', 'approve_rate_sum_60', 'reject_rate_pdl_60', 'reject_rate_int_60', 'reject_rate_sum_60', 'loan_rate_pdl_60', 'loan_rate_int_60', 'loan_rate_sum_60', 'loan_avg_pdl_60', 'loan_avg_int_60', 'loan_avg_sum_60', 'loan_times_pdl_60', 'loan_times_int_60', 'loan_times_sum_60', 'overdue_pdl_60', 'overdue_int_60', 'overdue_sum_60', 'pd7_pdl_60', 'pd7_int_60', 'pd7_sum_60', 'pd14_pdl_60', 'pd14_int_60', 'pd14_sum_60', 'M1_pdl_60', 'M1_int_60', 'M1_sum_60', 'maxOverdue_pdl_60', 'maxOverdue_int_60', 'maxOverdue_sum_60', 'avg_overdueday_pdl_60', 'avg_overdueday_int_60', 'avg_overdueday_sum_60', 'overdue_rate_pdl_60', 'overdue_rate_int_60', 'overdue_rate_sum_60', 'apply_pdl_90', 'apply_int_90', 'apply_sum_90', 'reject_pdl_90', 'reject_int_90', 'reject_sum_90', 'approve_pdl_90', 'approve_int_90', 'approve_sum_90', 'loanamount_pdl_90', 'loanamount_int_90', 'loanamount_sum_90', 'approve_rate_pdl_90', 'approve_rate_int_90', 'approve_rate_sum_90', 'reject_rate_pdl_90', 'reject_rate_int_90', 'reject_rate_sum_90', 'loan_rate_pdl_90', 'loan_rate_int_90', 'loan_rate_sum_90', 'loan_avg_pdl_90', 'loan_avg_int_90', 'loan_avg_sum_90', 'loan_times_pdl_90', 'loan_times_int_90', 'loan_times_sum_90', 'overdue_pdl_90', 'overdue_int_90', 'overdue_sum_90', 'pd7_pdl_90', 'pd7_int_90', 'pd7_sum_90', 'pd14_pdl_90', 'pd14_int_90', 'pd14_sum_90', 'M1_pdl_90', 'M1_int_90', 'M1_sum_90', 'maxOverdue_pdl_90', 'maxOverdue_int_90', 'maxOverdue_sum_90', 'avg_overdueday_pdl_90', 'avg_overdueday_int_90', 'avg_overdueday_sum_90', 'overdue_rate_pdl_90', 'overdue_rate_int_90', 'overdue_rate_sum_90', 'apply_pdl_180', 'apply_int_180', 'apply_sum_180', 'reject_pdl_180', 'reject_int_180', 'reject_sum_180', 'approve_pdl_180', 'approve_int_180', 'approve_sum_180', 'loanamount_pdl_180', 'loanamount_int_180', 'loanamount_sum_180', 'approve_rate_pdl_180', 'approve_rate_int_180', 'approve_rate_sum_180', 'reject_rate_pdl_180', 'reject_rate_int_180', 'reject_rate_sum_180', 'loan_rate_pdl_180', 'loan_rate_int_180', 'loan_rate_sum_180', 'loan_avg_pdl_180', 'loan_avg_int_180', 'loan_avg_sum_180', 'loan_times_pdl_180', 'loan_times_int_180', 'loan_times_sum_180', 'overdue_pdl_180', 'overdue_int_180', 'overdue_sum_180', 'pd7_pdl_180', 'pd7_int_180', 'pd7_sum_180', 'pd14_pdl_180', 'pd14_int_180', 'pd14_sum_180', 'M1_pdl_180', 'M1_int_180', 'M1_sum_180', 'maxOverdue_pdl_180', 'maxOverdue_int_180', 'maxOverdue_sum_180', 'avg_overdueday_pdl_180', 'avg_overdueday_int_180', 'avg_overdueday_sum_180', 'overdue_rate_pdl_180', 'overdue_rate_int_180', 'overdue_rate_sum_180', 'apply_pdl_365', 'apply_int_365', 'apply_sum_365', 'reject_pdl_365', 'reject_int_365', 'reject_sum_365', 'approve_pdl_365', 'approve_int_365', 'approve_sum_365', 'loanamount_pdl_365', 'loanamount_int_365', 'loanamount_sum_365', 'approve_rate_pdl_365', 'approve_rate_int_365', 'approve_rate_sum_365', 'reject_rate_pdl_365', 'reject_rate_int_365', 'reject_rate_sum_365', 'loan_rate_pdl_365', 'loan_rate_int_365', 'loan_rate_sum_365', 'loan_avg_pdl_365', 'loan_avg_int_365', 'loan_avg_sum_365', 'loan_times_pdl_365', 'loan_times_int_365', 'loan_times_sum_365', 'overdue_pdl_365', 'overdue_int_365', 'overdue_sum_365', 'pd7_pdl_365', 'pd7_int_365', 'pd7_sum_365', 'pd14_pdl_365', 'pd14_int_365', 'pd14_sum_365', 'M1_pdl_365', 'M1_int_365', 'M1_sum_365', 'maxOverdue_pdl_365', 'maxOverdue_int_365', 'maxOverdue_sum_365', 'avg_overdueday_pdl_365', 'avg_overdueday_int_365', 'avg_overdueday_sum_365', 'overdue_rate_pdl_365', 'overdue_rate_int_365', 'overdue_rate_sum_365', 'apply_pdl_all', 'apply_int_all', 'apply_sum_all', 'reject_pdl_all', 'reject_int_all', 'reject_sum_all', 'approve_pdl_all', 'approve_int_all', 'approve_sum_all', 'loanamount_pdl_all', 'loanamount_int_all', 'loanamount_sum_all', 'approve_rate_pdl_all', 'approve_rate_int_all', 'approve_rate_sum_all', 'reject_rate_pdl_all', 'reject_rate_int_all', 'reject_rate_sum_all', 'loan_rate_pdl_all', 'loan_rate_int_all', 'loan_rate_sum_all', 'loan_avg_pdl_all', 'loan_avg_int_all', 'loan_avg_sum_all', 'loan_times_pdl_all', 'loan_times_int_all', 'loan_times_sum_all', 'overdue_pdl_all', 'overdue_int_all', 'overdue_sum_all', 'pd7_pdl_all', 'pd7_int_all', 'pd7_sum_all', 'pd14_pdl_all', 'pd14_int_all', 'pd14_sum_all', 'M1_pdl_all', 'M1_int_all', 'M1_sum_all', 'maxOverdue_pdl_all', 'maxOverdue_int_all', 'maxOverdue_sum_all', 'avg_overdueday_pdl_all', 'avg_overdueday_int_all', 'avg_overdueday_sum_all', 'overdue_rate_pdl_all', 'overdue_rate_int_all', 'overdue_rate_sum_all', 'apply_pdl_weekday', 'apply_int_weekday', 'apply_sum_weekday', 'reject_pdl_weekday', 'reject_int_weekday', 'reject_sum_weekday', 'approve_pdl_weekday', 'approve_int_weekday', 'approve_sum_weekday', 'loanamount_pdl_weekday', 'loanamount_int_weekday', 'loanamount_sum_weekday', 'approve_rate_pdl_weekday', 'approve_rate_int_weekday', 'approve_rate_sum_weekday', 'reject_rate_pdl_weekday', 'reject_rate_int_weekday', 'reject_rate_sum_weekday', 'loan_rate_pdl_weekday', 'loan_rate_int_weekday', 'loan_rate_sum_weekday', 'loan_avg_pdl_weekday', 'loan_avg_int_weekday', 'loan_avg_sum_weekday', 'loan_times_pdl_weekday', 'loan_times_int_weekday', 'loan_times_sum_weekday', 'overdue_pdl_weekday', 'overdue_int_weekday', 'overdue_sum_weekday', 'pd7_pdl_weekday', 'pd7_int_weekday', 'pd7_sum_weekday', 'pd14_pdl_weekday', 'pd14_int_weekday', 'pd14_sum_weekday', 'M1_pdl_weekday', 'M1_int_weekday', 'M1_sum_weekday', 'maxOverdue_pdl_weekday', 'maxOverdue_int_weekday', 'maxOverdue_sum_weekday', 'avg_overdueday_pdl_weekday', 'avg_overdueday_int_weekday', 'avg_overdueday_sum_weekday', 'overdue_rate_pdl_weekday', 'overdue_rate_int_weekday', 'overdue_rate_sum_weekday', 'apply_pdl_weekend', 'apply_int_weekend', 'apply_sum_weekend', 'reject_pdl_weekend', 'reject_int_weekend', 'reject_sum_weekend', 'approve_pdl_weekend', 'approve_int_weekend', 'approve_sum_weekend', 'loanamount_pdl_weekend', 'loanamount_int_weekend', 'loanamount_sum_weekend', 'approve_rate_pdl_weekend', 'approve_rate_int_weekend', 'approve_rate_sum_weekend', 'reject_rate_pdl_weekend', 'reject_rate_int_weekend', 'reject_rate_sum_weekend', 'loan_rate_pdl_weekend', 'loan_rate_int_weekend', 'loan_rate_sum_weekend', 'loan_avg_pdl_weekend', 'loan_avg_int_weekend', 'loan_avg_sum_weekend', 'loan_times_pdl_weekend', 'loan_times_int_weekend', 'loan_times_sum_weekend', 'overdue_pdl_weekend', 'overdue_int_weekend', 'overdue_sum_weekend', 'pd7_pdl_weekend', 'pd7_int_weekend', 'pd7_sum_weekend', 'pd14_pdl_weekend', 'pd14_int_weekend', 'pd14_sum_weekend', 'M1_pdl_weekend', 'M1_int_weekend', 'M1_sum_weekend', 'maxOverdue_pdl_weekend', 'maxOverdue_int_weekend', 'maxOverdue_sum_weekend', 'avg_overdueday_pdl_weekend', 'avg_overdueday_int_weekend', 'avg_overdueday_sum_weekend', 'overdue_rate_pdl_weekend', 'overdue_rate_int_weekend', 'overdue_rate_sum_weekend', 'apply_pdl_earlyMorning', 'apply_int_earlyMorning', 'apply_sum_earlyMorning', 'reject_pdl_earlyMorning', 'reject_int_earlyMorning', 'reject_sum_earlyMorning', 'approve_pdl_earlyMorning', 'approve_int_earlyMorning', 'approve_sum_earlyMorning', 'loanamount_pdl_earlyMorning', 'loanamount_int_earlyMorning', 'loanamount_sum_earlyMorning', 'approve_rate_pdl_earlyMorning', 'approve_rate_int_earlyMorning', 'approve_rate_sum_earlyMorning', 'reject_rate_pdl_earlyMorning', 'reject_rate_int_earlyMorning', 'reject_rate_sum_earlyMorning', 'loan_rate_pdl_earlyMorning', 'loan_rate_int_earlyMorning', 'loan_rate_sum_earlyMorning', 'loan_avg_pdl_earlyMorning', 'loan_avg_int_earlyMorning', 'loan_avg_sum_earlyMorning', 'loan_times_pdl_earlyMorning', 'loan_times_int_earlyMorning', 'loan_times_sum_earlyMorning', 'overdue_pdl_earlyMorning', 'overdue_int_earlyMorning', 'overdue_sum_earlyMorning', 'pd7_pdl_earlyMorning', 'pd7_int_earlyMorning', 'pd7_sum_earlyMorning', 'pd14_pdl_earlyMorning', 'pd14_int_earlyMorning', 'pd14_sum_earlyMorning', 'M1_pdl_earlyMorning', 'M1_int_earlyMorning', 'M1_sum_earlyMorning', 'maxOverdue_pdl_earlyMorning', 'maxOverdue_int_earlyMorning', 'maxOverdue_sum_earlyMorning', 'avg_overdueday_pdl_earlyMorning', 'avg_overdueday_int_earlyMorning', 'avg_overdueday_sum_earlyMorning', 'overdue_rate_pdl_earlyMorning', 'overdue_rate_int_earlyMorning', 'overdue_rate_sum_earlyMorning', 'apply_pdl_morning', 'apply_int_morning', 'apply_sum_morning', 'reject_pdl_morning', 'reject_int_morning', 'reject_sum_morning', 'approve_pdl_morning', 'approve_int_morning', 'approve_sum_morning', 'loanamount_pdl_morning', 'loanamount_int_morning', 'loanamount_sum_morning', 'approve_rate_pdl_morning', 'approve_rate_int_morning', 'approve_rate_sum_morning', 'reject_rate_pdl_morning', 'reject_rate_int_morning', 'reject_rate_sum_morning', 'loan_rate_pdl_morning', 'loan_rate_int_morning', 'loan_rate_sum_morning', 'loan_avg_pdl_morning', 'loan_avg_int_morning', 'loan_avg_sum_morning', 'loan_times_pdl_morning', 'loan_times_int_morning', 'loan_times_sum_morning', 'overdue_pdl_morning', 'overdue_int_morning', 'overdue_sum_morning', 'pd7_pdl_morning', 'pd7_int_morning', 'pd7_sum_morning', 'pd14_pdl_morning', 'pd14_int_morning', 'pd14_sum_morning', 'M1_pdl_morning', 'M1_int_morning', 'M1_sum_morning', 'maxOverdue_pdl_morning', 'maxOverdue_int_morning', 'maxOverdue_sum_morning', 'avg_overdueday_pdl_morning', 'avg_overdueday_int_morning', 'avg_overdueday_sum_morning', 'overdue_rate_pdl_morning', 'overdue_rate_int_morning', 'overdue_rate_sum_morning', 'apply_pdl_noon', 'apply_int_noon', 'apply_sum_noon', 'reject_pdl_noon', 'reject_int_noon', 'reject_sum_noon', 'approve_pdl_noon', 'approve_int_noon', 'approve_sum_noon', 'loanamount_pdl_noon', 'loanamount_int_noon', 'loanamount_sum_noon', 'approve_rate_pdl_noon', 'approve_rate_int_noon', 'approve_rate_sum_noon', 'reject_rate_pdl_noon', 'reject_rate_int_noon', 'reject_rate_sum_noon', 'loan_rate_pdl_noon', 'loan_rate_int_noon', 'loan_rate_sum_noon', 'loan_avg_pdl_noon', 'loan_avg_int_noon', 'loan_avg_sum_noon', 'loan_times_pdl_noon', 'loan_times_int_noon', 'loan_times_sum_noon', 'overdue_pdl_noon', 'overdue_int_noon', 'overdue_sum_noon', 'pd7_pdl_noon', 'pd7_int_noon', 'pd7_sum_noon', 'pd14_pdl_noon', 'pd14_int_noon', 'pd14_sum_noon', 'M1_pdl_noon', 'M1_int_noon', 'M1_sum_noon', 'maxOverdue_pdl_noon', 'maxOverdue_int_noon', 'maxOverdue_sum_noon', 'avg_overdueday_pdl_noon', 'avg_overdueday_int_noon', 'avg_overdueday_sum_noon', 'overdue_rate_pdl_noon', 'overdue_rate_int_noon', 'overdue_rate_sum_noon', 'apply_pdl_afternoon', 'apply_int_afternoon', 'apply_sum_afternoon', 'reject_pdl_afternoon', 'reject_int_afternoon', 'reject_sum_afternoon', 'approve_pdl_afternoon', 'approve_int_afternoon', 'approve_sum_afternoon', 'loanamount_pdl_afternoon', 'loanamount_int_afternoon', 'loanamount_sum_afternoon', 'approve_rate_pdl_afternoon', 'approve_rate_int_afternoon', 'approve_rate_sum_afternoon', 'reject_rate_pdl_afternoon', 'reject_rate_int_afternoon', 'reject_rate_sum_afternoon', 'loan_rate_pdl_afternoon', 'loan_rate_int_afternoon', 'loan_rate_sum_afternoon', 'loan_avg_pdl_afternoon', 'loan_avg_int_afternoon', 'loan_avg_sum_afternoon', 'loan_times_pdl_afternoon', 'loan_times_int_afternoon', 'loan_times_sum_afternoon', 'overdue_pdl_afternoon', 'overdue_int_afternoon', 'overdue_sum_afternoon', 'pd7_pdl_afternoon', 'pd7_int_afternoon', 'pd7_sum_afternoon', 'pd14_pdl_afternoon', 'pd14_int_afternoon', 'pd14_sum_afternoon', 'M1_pdl_afternoon', 'M1_int_afternoon', 'M1_sum_afternoon', 'maxOverdue_pdl_afternoon', 'maxOverdue_int_afternoon', 'maxOverdue_sum_afternoon', 'avg_overdueday_pdl_afternoon', 'avg_overdueday_int_afternoon', 'avg_overdueday_sum_afternoon', 'overdue_rate_pdl_afternoon', 'overdue_rate_int_afternoon', 'overdue_rate_sum_afternoon', 'apply_pdl_evening', 'apply_int_evening', 'apply_sum_evening', 'reject_pdl_evening', 'reject_int_evening', 'reject_sum_evening', 'approve_pdl_evening', 'approve_int_evening', 'approve_sum_evening', 'loanamount_pdl_evening', 'loanamount_int_evening', 'loanamount_sum_evening', 'approve_rate_pdl_evening', 'approve_rate_int_evening', 'approve_rate_sum_evening', 'reject_rate_pdl_evening', 'reject_rate_int_evening', 'reject_rate_sum_evening', 'loan_rate_pdl_evening', 'loan_rate_int_evening', 'loan_rate_sum_evening', 'loan_avg_pdl_evening', 'loan_avg_int_evening', 'loan_avg_sum_evening', 'loan_times_pdl_evening', 'loan_times_int_evening', 'loan_times_sum_evening', 'overdue_pdl_evening', 'overdue_int_evening', 'overdue_sum_evening', 'pd7_pdl_evening', 'pd7_int_evening', 'pd7_sum_evening', 'pd14_pdl_evening', 'pd14_int_evening', 'pd14_sum_evening', 'M1_pdl_evening', 'M1_int_evening', 'M1_sum_evening', 'maxOverdue_pdl_evening', 'maxOverdue_int_evening', 'maxOverdue_sum_evening', 'avg_overdueday_pdl_evening', 'avg_overdueday_int_evening', 'avg_overdueday_sum_evening', 'overdue_rate_pdl_evening', 'overdue_rate_int_evening', 'overdue_rate_sum_evening', 'apply_pdl_night', 'apply_int_night', 'apply_sum_night', 'reject_pdl_night', 'reject_int_night', 'reject_sum_night', 'approve_pdl_night', 'approve_int_night', 'approve_sum_night', 'loanamount_pdl_night', 'loanamount_int_night', 'loanamount_sum_night', 'approve_rate_pdl_night', 'approve_rate_int_night', 'approve_rate_sum_night', 'reject_rate_pdl_night', 'reject_rate_int_night', 'reject_rate_sum_night', 'loan_rate_pdl_night', 'loan_rate_int_night', 'loan_rate_sum_night', 'loan_avg_pdl_night', 'loan_avg_int_night', 'loan_avg_sum_night', 'loan_times_pdl_night', 'loan_times_int_night', 'loan_times_sum_night', 'overdue_pdl_night', 'overdue_int_night', 'overdue_sum_night', 'pd7_pdl_night', 'pd7_int_night', 'pd7_sum_night', 'pd14_pdl_night', 'pd14_int_night', 'pd14_sum_night', 'M1_pdl_night', 'M1_int_night', 'M1_sum_night', 'maxOverdue_pdl_night', 'maxOverdue_int_night', 'maxOverdue_sum_night', 'avg_overdueday_pdl_night', 'avg_overdueday_int_night', 'avg_overdueday_sum_night', 'overdue_rate_pdl_night', 'overdue_rate_int_night', 'overdue_rate_sum_night', 'last_loan_interval', 'last_loan_hour_interval', 'last_loan_minute_interval', 'last_repay_interval', 'last_repay_hour_interval', 'last_overdue_day', 'apply_pdl_diff_1', 'apply_int_diff_1', 'approve_pdl_diff_1', 'approve_int_diff_1', 'apply_pdl_diff_2', 'apply_int_diff_2', 'approve_pdl_diff_2', 'approve_int_diff_2', 'apply_pdl_diff_3', 'apply_int_diff_3', 'approve_pdl_diff_3', 'approve_int_diff_3', 'apply_pdl_diff_4', 'apply_int_diff_4', 'approve_pdl_diff_4', 'approve_int_diff_4', 'apply_pdl_diff_5', 'apply_int_diff_5', 'approve_pdl_diff_5', 'approve_int_diff_5', 'apply_pdl_diff_6', 'apply_int_diff_6', 'approve_pdl_diff_6', 'approve_int_diff_6', 'apply_pdl_diff_7', 'apply_int_diff_7', 'approve_pdl_diff_7', 'approve_int_diff_7', 'apply_pdl_diff_8', 'apply_int_diff_8', 'approve_pdl_diff_8', 'approve_int_diff_8', 'apply_pdl_diff_9', 'apply_int_diff_9', 'approve_pdl_diff_9', 'approve_int_diff_9', 'apply_pdl_diff_10', 'apply_int_diff_10', 'approve_pdl_diff_10', 'approve_int_diff_10', 'apply_pdl_diff_11', 'apply_int_diff_11', 'approve_pdl_diff_11', 'approve_int_diff_11', 'apply_pdl_diff_12', 'apply_int_diff_12', 'approve_pdl_diff_12', 'approve_int_diff_12', 'apply_pdl_diff_13', 'apply_int_diff_13', 'approve_pdl_diff_13', 'approve_int_diff_13', 'apply_mert_pdl_diff_1', 'apply_mert_int_diff_1', 'approve_mert_pdl_diff_1', 'approve_mert_int_diff_1', 'apply_mert_pdl_diff_2', 'apply_mert_int_diff_2', 'approve_mert_pdl_diff_2', 'approve_mert_int_diff_2', 'apply_mert_pdl_diff_3', 'apply_mert_int_diff_3', 'approve_mert_pdl_diff_3', 'approve_mert_int_diff_3', 'apply_mert_pdl_diff_4', 'apply_mert_int_diff_4', 'approve_mert_pdl_diff_4', 'approve_mert_int_diff_4', 'apply_mert_pdl_diff_5', 'apply_mert_int_diff_5', 'approve_mert_pdl_diff_5', 'approve_mert_int_diff_5', 'apply_mert_pdl_diff_6', 'apply_mert_int_diff_6', 'approve_mert_pdl_diff_6', 'approve_mert_int_diff_6', 'apply_mert_pdl_diff_7', 'apply_mert_int_diff_7', 'approve_mert_pdl_diff_7', 'approve_mert_int_diff_7', 'apply_mert_pdl_diff_8', 'apply_mert_int_diff_8', 'approve_mert_pdl_diff_8', 'approve_mert_int_diff_8', 'apply_mert_pdl_diff_9', 'apply_mert_int_diff_9', 'approve_mert_pdl_diff_9', 'approve_mert_int_diff_9', 'apply_mert_pdl_diff_10', 'apply_mert_int_diff_10', 'approve_mert_pdl_diff_10', 'approve_mert_int_diff_10', 'apply_mert_pdl_diff_11', 'apply_mert_int_diff_11', 'approve_mert_pdl_diff_11', 'approve_mert_int_diff_11', 'apply_mert_pdl_diff_12', 'apply_mert_int_diff_12', 'approve_mert_pdl_diff_12', 'approve_mert_int_diff_12', 'apply_mert_pdl_diff_13', 'apply_mert_int_diff_13', 'approve_mert_pdl_diff_13', 'approve_mert_int_diff_13', 'apply_mert_pdl_sum', 'apply_mert_int_sum', 'approve_mert_pdl_sum', 'approve_mert_int_sum', 'apply_interval_0_1', 'apply_interval_1_3', 'apply_interval_3_7', 'apply_interval_7_14', 'apply_interval_14_30', 'apply_interval_30_60', 'apply_interval_60_90', 'apply_interval_90_180', 'apply_interval_180_360', 'apply_interval_360_9999', 'apply_interval_mean', 'apply_interval_std', 'apply_interval_1_minute', 'apply_interval_3_minute', 'apply_interval_10_minute', 'apply_interval_1_hour', 'apply_interval_1_minute_rate', 'apply_interval_3_minute_rate', 'apply_interval_10_minute_rate', 'apply_interval_1_hour_rate', 'apply_interval_1_day', 'apply_interval_3_day', 'call_max_overdue_sum', 'call_max_overdue_pdl', 'call_max_overdue_int', 'call_max_overdue_times', 'call_max_apply_sum', 'call_max_approve_sum', 'call_max_loanamount_sum', 'call_avg_overdue_sum', 'call_avg_overdue_pdl', 'call_avg_overdue_int', 'call_avg_overdue_times', 'call_avg_apply_sum', 'call_avg_approve_sum', 'call_avg_loanamount_sum', 'contact_max_overdue_sum', 'contact_max_overdue_pdl', 'contact_max_overdue_int', 'contact_max_overdue_times', 'contact_max_apply_sum', 'contact_max_approve_sum', 'contact_max_loanamount_sum', 'contact_avg_overdue_sum', 'contact_avg_overdue_pdl', 'contact_avg_overdue_int', 'contact_avg_overdue_times', 'contact_avg_apply_sum', 'contact_avg_approve_sum', 'contact_avg_loanamount_sum', 'have_same_phone_user']


def oot_train_split_pro(allData):
    allData['split1'] = allData['create_time'].apply(
        lambda x: 'oot' if x >= '2019-01-01'  else 'train')
    for name, group in allData.groupby('split1'):
        print(name,group.shape)
        if name is 'oot':
            oot1 = group
        else:
            train = group

    return oot1

def jinpan_merchant_analysis():
    jiaka_df = pd.read_csv('EI_jinpan_addr.csv')

    jiaka_df = oot_train_split_pro(jiaka_df)

    apply_mert_int_sum = jiaka_df['apply_mert_int_sum'].count()
    mert_int_mean = jiaka_df['apply_mert_int_sum'].mean()
    mert_pdl_mean = jiaka_df['apply_mert_pdl_sum'].mean()

    apply_mert_pdl_sum = jiaka_df['apply_mert_pdl_sum'].count()

    apply_sum_all = jiaka_df['apply_sum_all'].count()

    print('jiaka 历史命中情况', apply_sum_all, apply_sum_all / jiaka_df.shape[0])

    print('jiaka mert情况', mert_int_mean, jiaka_df['apply_mert_int_sum'].max(),
          mert_pdl_mean,jiaka_df['apply_mert_pdl_sum'].max() )

    print('jiaka int mert命中情况', apply_mert_int_sum, apply_mert_int_sum / jiaka_df.shape[0])

    print('jiaka pdl mert命中情况', apply_mert_pdl_sum, apply_mert_pdl_sum / jiaka_df.shape[0])

def date_map(x):
    # month = str(x)[4:6]
    # print(month)

    month = str(x)[5:7]
    # print(month)

    return month

def jinpan_feature_analysis():
    df = pd.read_csv('data/EI_jinpan_addr.csv')

    cat_features = [cont for cont in list(df.select_dtypes(
        include=['float64', 'int64']).columns)
                    if
                    'apply' in cont and
                    '7' in cont ]

    df = oot_train_split_pro(df)

    df['date'] = df['create_time'].map(date_map)
    # df = df[df.apply_int_30<10]

    apply_7 = df[['date','apply_mert_int_sum','apply_mert_pdl_sum']]
    apply_7 = apply_7.dropna(how='any')
    plot_check(apply_7)

    print(apply_7.shape,df.shape)


def plot_check(df ):
    df = df.set_index('date')
    # plt.show()
    df.plot()
    plt.show()

if __name__ == '__main__':
    # jinpan_merchant_analysis()

    jinpan_feature_analysis()

